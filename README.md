# A Flexible Recipe for Deployment to Multiple Environments Using Pulumi, Kubernetes and Github Actions
The following is a recipe for managing and testing application deployments in different environments (local, staging, feature branch). 

## Key Features
- Local deployment recipe
- AWS deployment recipe

## Prerequisites
- [AWS account](https://aws.amazon.com/account/)
- [Cloudflare account](https://www.cloudflare.com/en-ca/)
- [Github account](https://github.com)
- [Pulumi account](https://www.pulumi.com/)
- [Pulumi installation](https://www.pulumi.com/docs/get-started/kubernetes/begin/)

## Tools
- [Certmanager](https://github.com/cert-manager/cert-manager) and [Let's Encrypt](https://letsencrypt.org/) to manage SSL certifications
- [Cloudflare](https://www.cloudflare.com/en-ca/) for domain management
- [Earthly](https://earthly.dev/) for reproducible builds
- [Elixir](https://elixir-lang.org/) and [Phoenix](https://www.phoenixframework.org/) for the demo application
- [Github Actions](https://github.com/features/actions) to trigger deployments on different branches
- [Minikube](https://minikube.sigs.k8s.io/docs/start/) to Kubernetes clusters locally 
- [Nginx](https://www.nginx.com/) as the reverse proxy
- [Pulumi](https://www.pulumi.com/) for instrastructure as code
- [Postgres](https://www.postgresql.org/) as the database inside the Kubernetes cluster

## Comments/Questions
Please open an issue or a discussion or send me a message on [Twitter](https://twitter.com/vinnerroy).

## Usage
Start by running `pulumi new kubernetes-typescript` inside your project which will generate scaffold in the folder of your choice and then use `Earthfile` and files inside the `deployment` folder to augment your app. The contents inside `deployment` were first generated by running `pulumi new kubernetes-typescript` inside an `deployment` folder.

## Local Deployment
You might want to call your [Pulumi stack](https://www.pulumi.com/docs/intro/concepts/stack/) something like `local` for this use-case.


## Production Deployment
You might want to call your [Pulumi stack](https://www.pulumi.com/docs/intro/concepts/stack/) something like `production` for this use-case.

Work in progress...

## Beta Deployment
You might want to call your [Pulumi stack](https://www.pulumi.com/docs/intro/concepts/stack/) something like `beta` for this use-case.

Work in progress...

## Feature Branch/PR Deployment
You probably want to name your [Pulumi stack](https://www.pulumi.com/docs/intro/concepts/stack/) automatically based on the branch name for this use-case.

Work in progress...
